---
title: "Exam 2 Practice Key (code)"
author: "BIOL 305"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r, echo = F}
library(tidyverse)
library(moments)
library(DescTools)
```

Please complete the following problems as practice for Exam 2. *Note* that you may need to load specific packages from the previous exercises to get your code to work.

**All questions must be answered in full sentences**.

**Example answers**: For your conclusion, answers should look like this:

| The mean height of the class is significantly higher than the height of the general population (\$Z\$ = 2.50, $p = 0.006$).

| The mean length of the leg of the high-elevation Woodhouse's Toads (*Anaxyrus woodhousii*) is indistinguishable from those of the general population ($Z = 0.12$, $p = 0.45$).

## Minnows

Consider this scenario: You have discovered a never-before-documented population of minnow in the Kearney Canal near campus. During your first sampling trip, you notice that the total length (i.e., measured from the tip of the snout to the very tip of the tail) of the fish you measure appear to be smaller than the average total length of the species as recorded among all known individuals across their range. The mean total length noted in one publication is 85.00 mm with a standard deviation of 4.50. Below are your data from 20 minnows that you captured during your first sampling trip to the Kearney Canal:

| Fish ID | Length (mm) |
|---------|-------------|
| 1       | 89.58       |
| 2       | 75.44       |
| 3       | 86.86       |
| 4       | 74.71       |
| 5       | 69.70       |
| 6       | 100.34      |
| 7       | 73.70       |
| 8       | 69.56       |
| 9       | 96.24       |
| 10      | 79.35       |
| 11      | 61.37       |
| 12      | 62.82       |
| 13      | 95.45       |
| 14      | 98.71       |
| 15      | 100.34      |
| 16      | 57.57       |
| 17      | 70.54       |
| 18      | 78.65       |
| 19      | 65.39       |
| 20      | 65.57       |

: Fish data for this problem.

NOTE: you will have to create the numeric object for this problem. use `c` to link things together; e.g.:

```{r, echo = F}
x <- c(1,5,8,9)
x
```

```{r, echo = F}
minnow.length <- c(89.58,75.44,86.86,74.71,69.70,
                   100.34,73.70,69.56,96.24,79.35,
                   61.37,62.82,95.45,98.71,100.34,
                   57.57,70.54,78.65,65.39,65.57)
```

1.  State the null and alternative hypotheses for this study.

$H_0$: The mean length of minnows in the Kearney Canal is not smaller than the mean length of other minnow populations. 

$H_A$: The mean length of minnows in the Kearney Canal is less than the length of other minnow populations.

2.  Calculate the first quartile, median, third quartile, and interquartile range of your response variable. Create a boxplot. Based on your results, are there any outliers in your data? Explain.

```{r, echo = F}
quantile(minnow.length, type = 6) |> round(2)
```

```{r, echo = F}
IQR(minnow.length, type = 6) |> round(2)
```

```{r, echo = F}
boxplot(minnow.length, ylab = "Minnow length (mm)")
```

The median length of minnows is 75.07 mm, with a lower quartile of 66.57 mm and an upper quartile of 93.98 mm. The interquartile range is 27.42 mm. There are no outliers.

3.  Calculate the $z$-score for this scenario.

```{r, echo = F}
### DO NOT EDIT ###
# RUN EXACTLY AS IS #
# Use as function like mean#
zscore <- function(xbar, mu, sd.x, n = 1){
  z <- (xbar - mu)/(sd.x/sqrt(n))
  return(z)
}
```

```{r, echo = F}
Z <- zscore(xbar = mean(minnow.length), mu = 85,
       sd.x = 4.50, n = length(minnow.length))
Z |> round(2)
```

The $Z$ score is -6.37.

4.  What is the probability that, by random chance alone, you would find your observed mean or something more extreme?

```{r, echo = F}
pnorm(Z)
```

The $p$ value is $< 0.0001$.

5.  Assume that you set your $\alpha$ for your study prior to your data collection to 0.05. Based on this information and the $p$ value you obtained, is your null hypothesis supported or rejected? Report your conclusion in a full sentence, including the $Z$ score and the $p$ value in your answer.

The mean length of minnows in the Kearney Canal is less than the mean length of published minnow populations ($Z = 6.37$, $p < 0.0001$).

## Time spent on canvas

You are curious about how much time your classmates spend on Canvas for BIOL305. Let's say you get the following data for the amount of time folks spend on Canvas:

```{r, echo = F}
time.hrs <- c(19.65, 69.29, 6.83, 5.50, 17.98,
              19.89, 8.52, 71.37, 12.62, 4.62,
              3.00, 5.69, 10.79, 6.59, 32.56, 
              15.72, 3.67, 10.04, 5.45, 3.69, 
              20.17, 12.99, 1.56, 2.40, 55.20)

student <- 1:length(time.hrs)

time_on_canvas <- cbind(student, time.hrs) |> 
  as.data.frame() |> 
  mutate(time.hrs = as.numeric(time.hrs)) |> 
  mutate(student = as.numeric(student))

head(time_on_canvas)
```

1.  Which variable is the response variable? What type of data are these?
2.  Is the response variable normally distributed? Support your answer with a histogram, a cumulative frequency plot, assessments of skewness and kurtosis, and an indication of if outliers exist. Change the title and axes labels of the plots to make them intelligible.

```{r, echo = F}
hist(time.hrs, main = "Time (hrs)", xlab = "Hours")
```

```{r, echo = F}
plot(ecdf(time.hrs), main = "Cumulative summary (time in hours)",
     xlab = "Hours")
```

```{r, echo = F}
boxplot(time.hrs, ylab = "Time (hrs)")
```

Shapiro-Wilkes test:

```{r, echo = F}
shapiro.test(time.hrs)
```

Kurtosis:

```{r, echo = F}
(kurtosis(time.hrs)-3) |> round(2)
```

Skewness:

```{r, echo = F}
skewness(time.hrs) |> round(2)
```

Outliers:

```{r, echo = F}
Outlier(time.hrs)
```

The data are not normal. (NOTE - you will have to cite THREE pieces of evidence above in *your* answer).

1.  If a transformation is needed, which transformation is required? *Note* - you only have to do a histogram and a `shapiro.test` to assess a transformation. As soon as you find a transformation that works, you do not have to do another.

**Transformation**:

```{r, echo = F}
log.hrs <- log1p(time.hrs)

hist(log.hrs, xlab = "Hours (log transformed)", main = "Histogram of Log of Hours")
```

```{r, echo = F}
plot(ecdf(log.hrs), main = "Cumulative Frequency of Time in Hours", xlab = "Log of Hours")
```

```{r, echo = F}
shapiro.test(log.hrs)
```

A log transformation successfully makes the data normal.

1.  What is the 95% confidence interval for the mean of these data? Report as the mean +/- the confidence interval, and answer in a full sentence. Don't forget to mention the units of your answer. HINT: you may have to back-transform your data.

```{r, echo = F}
ci.log <- qnorm(0.975)*(sd(log.hrs)/sqrt(length(log.hrs)))

mu <- mean(log.hrs)

ucl <- (mu+ci.log) |> expm1()
lcl <- (mu-ci.log) |> expm1()
```

The average is `r expm1(mu) |> round(2)` hours, with a confidence interval of `r lcl |> round(2)` to `r ucl |> round(2)` hours.
